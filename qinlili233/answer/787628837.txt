手机计算器是如何较快算出 4500! 的值的？
<h2>结论：真他娘死算的</h2><p data-pid="WRc-FahS">这是one++的阶乘。因为one++代码比较小，dex不到1m，就拿这个开刀把</p><figure data-size="small"><noscript><img src="https://pic1.zhimg.com/v2-e370b38b919512b7c3627e0fa2ab8f60_720w.jpg?source=3af55fa1" data-caption="" data-size="small" data-rawwidth="1080" data-rawheight="2340" data-default-watermark-src="https://pica.zhimg.com/v2-0100892fd9a41a401036f2fe8e25b707_720w.jpg?source=3af55fa1" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pica.zhimg.com/v2-e370b38b919512b7c3627e0fa2ab8f60_r.jpg?source=3af55fa1"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='1080'%20height='2340'&gt;&lt;/svg&gt;" data-caption="" data-size="small" data-rawwidth="1080" data-rawheight="2340" data-default-watermark-src="https://pica.zhimg.com/v2-0100892fd9a41a401036f2fe8e25b707_720w.jpg?source=3af55fa1" class="origin_image zh-lightbox-thumb lazy" width="1080" data-original="https://pica.zhimg.com/v2-e370b38b919512b7c3627e0fa2ab8f60_r.jpg?source=3af55fa1" data-actualsrc="https://pic1.zhimg.com/v2-e370b38b919512b7c3627e0fa2ab8f60_720w.jpg?source=3af55fa1"></figure><p data-pid="OwtoIGDB">关键代码</p><figure data-size="small"><noscript><img src="https://pic3.zhimg.com/v2-79bc4f1e3f719e51a770f60ed5cd79b9_720w.jpg?source=3af55fa1" data-caption="" data-size="small" data-rawwidth="1080" data-rawheight="2340" data-default-watermark-src="https://pic2.zhimg.com/v2-a608a972a7df8b5c2328c72403376a84_720w.jpg?source=3af55fa1" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic1.zhimg.com/v2-79bc4f1e3f719e51a770f60ed5cd79b9_r.jpg?source=3af55fa1"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='1080'%20height='2340'&gt;&lt;/svg&gt;" data-caption="" data-size="small" data-rawwidth="1080" data-rawheight="2340" data-default-watermark-src="https://pic2.zhimg.com/v2-a608a972a7df8b5c2328c72403376a84_720w.jpg?source=3af55fa1" class="origin_image zh-lightbox-thumb lazy" width="1080" data-original="https://pic1.zhimg.com/v2-79bc4f1e3f719e51a770f60ed5cd79b9_r.jpg?source=3af55fa1" data-actualsrc="https://pic3.zhimg.com/v2-79bc4f1e3f719e51a770f60ed5cd79b9_720w.jpg?source=3af55fa1"></figure><p data-pid="D83OTQdO">我们具体分析</p><p data-pid="jkMtTE4w">.method public aa()V//方法名有混淆，我们不去管它</p><p data-pid="wAhdfm28">   .registers 5//注册了五个变量</p><p data-pid="62YXQRJa">   iget v0, p0, Lcom/saschaha/easy4me/c/s;-&gt;V:I//读取整数寄存器，也就是阶乘值</p><p data-pid="pxA6jMvq">   const/4 v1, 0x1//定义变量v1为1</p><p data-pid="XeEC0EKH">   if-le v0, v1, :cond_1a//如果v0也就是阶乘值小于v1也就是1就滚去1a标签（结束运算）</p><p data-pid="WVvAzEIx">   const/4 v0, 0x2//定义v0为2</p><p data-pid="znobuoc2">   :goto_6//标签6</p><p data-pid="SYwmrDGl">   iget v1, p0, Lcom/saschaha/easy4me/c/s;-&gt;V:I//读取阶乘值到v1</p><p data-pid="-RyAWbua">   if-gt v0, v1, :cond_1a//如果v0（上一步计算到的值）大于v1（阶乘值），滚去1a标签（输出结果）</p><p data-pid="W5dlFu8m">   iget-object v1, p0, Lcom/saschaha/easy4me/c/s;-&gt;W:Ljava/math/BigInteger;//读取BigInteger格式变量，实际就是阶乘值，只是换了格式加速计算</p><p data-pid="8jKUez0C">   int-to-long v2, v0//把v0转换为长整形并保存在v2（防止integer溢出）</p><p data-pid="GnVUq-uq">   invoke-static {v2, v3}, Ljava/math/BigInteger;-&gt;valueOf(J)Ljava/math/BigInteger;//v3现在是空的，这个操作就是把长整形转换为BigInteger</p><p data-pid="fovUEQGF">   move-result-object v2//保存结果到v2</p><p data-pid="p7KFMZkx">   invoke-virtual {v1, v2}, Ljava/math/BigInteger;-&gt;multiply(Ljava/math/BigInteger;)Ljava/math/BigInteger;//v1和v2相乘</p><p data-pid="BF-dDdZ2">   move-result-object v1//保存结果到v1</p><p data-pid="E1MPT5nI">   iput-object v1, p0, Lcom/saschaha/easy4me/c/s;-&gt;W:Ljava/math/BigInteger;//把v1塞回去</p><p data-pid="wD-tUz0n">   add-int/lit8 v0, v0, 0x1//给v0加1</p><p data-pid="_wzf3LKo">   goto :goto_6//回到标签6</p><p data-pid="jAHEY68H">   :cond_1a//标签1a</p><p data-pid="tK_qlsR_">   invoke-direct {p0}, Lcom/saschaha/easy4me/c/s;-&gt;ab()V//输出结果</p><p data-pid="D0qJVR63">   return-void//结束了</p><p data-pid="QrQZdiiS">.end method</p><p><br></p><p data-pid="QL6C-2h2">补充：下面一些答主写的算法确实可行，但是用Java很难写，可能需要引入native库在c层跑，所以大部分开发计算器类app的开发者更喜欢死乘，反正现在oat过程会编译优化，优化丢给预编译和jit就行了</p><p><br></p><p data-pid="xZRYlaV4">个人做的one++修改版，优化启动速率+支持自适应图标</p><p data-pid="Ci0C2lLb">One++_Shiori.apk: <a href="http://link.zhihu.com/?target=https%3A//qinlili.ctfile.com/fs/8067059-392656640" class=" wrap external" target="_blank" rel="nofollow noreferrer">One++_Shiori.apk - 免费高速下载 - 城通网盘-50TB超大网盘</a></p><p data-pid="c9s46uhA">阶乘在Lcom/saschaha/easy4me/c/s;</p>
1565866230