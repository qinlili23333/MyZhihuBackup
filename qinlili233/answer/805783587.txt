如何看待今日头条自媒体发布谣言称「支付宝几乎秒开是因为采用华为方舟编译器」？
<h2><b>先送上逆向后的结论：支付宝自己代码写的牛批</b></h2><p data-pid="SJ7He6fb">很多开发者有一个习惯，准确来说是陋习，就是啥都要丢进application初始化</p><p data-pid="R4-__bt-"><b>但是支付宝没有</b></p><p data-pid="3ImE34gc"><b>支付宝仅仅初始化了容器</b></p><p data-pid="sIhigyrA">app启动时不管启动activity，启动service，还是触发receiver，都必然要先加载application</p><p data-pid="GZVbnYzV">如果application里面初始化的东西太多，就会导致大量的时间用在初始化上，这就造成启动慢，甚至初始化过程如果出现阻塞，可能导致ANR</p><p data-pid="qtdZnHq6">支付宝通过只初始化容器核心，把application的初始化压缩到短短数步，速度自然就上来了</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-f9f5396dbe0603adca6a8238110e9c85_720w.jpg?source=3af55fa1" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="2340" data-default-watermark-src="https://pic3.zhimg.com/v2-9a9e534366a85d575ef5ea5a8b656e2e_720w.jpg?source=3af55fa1" class="origin_image zh-lightbox-thumb" width="1080" data-original="https://pic3.zhimg.com/v2-f9f5396dbe0603adca6a8238110e9c85_r.jpg?source=3af55fa1"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='1080'%20height='2340'&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1080" data-rawheight="2340" data-default-watermark-src="https://pic3.zhimg.com/v2-9a9e534366a85d575ef5ea5a8b656e2e_720w.jpg?source=3af55fa1" class="origin_image zh-lightbox-thumb lazy" width="1080" data-original="https://pic3.zhimg.com/v2-f9f5396dbe0603adca6a8238110e9c85_r.jpg?source=3af55fa1" data-actualsrc="https://pic1.zhimg.com/v2-f9f5396dbe0603adca6a8238110e9c85_720w.jpg?source=3af55fa1"></figure><p data-pid="eiqB326d">当然，sdk不初始化没法用，这是事实。<b>但是不是你打开app就会用到所有sdk啊！</b></p><p data-pid="J_pUA2TV"><b>支付宝还聪明在按需初始化</b></p><p data-pid="E-0jZ8QN">在application里我注意到一个方法.method public isMainProcess()Z</p><p data-pid="B12oTJ7D">判断是否主进程。</p><p data-pid="7dwdxzVt">支付宝的多进程做的很到位，除了分离推送进程外，小程序也实现了分离进程。</p><p data-pid="0wgGxMe-">比如你看推送进程，不需要初始化webview吧，也不需要初始化统计组件吧</p><p data-pid="j17cpYXT">你看这不就节约资源了吗？</p><p data-pid="X7_xP2Mw"><b>任何进程孵化时都会加载application，如果不判断进程就全部加载，会导致在无关线程上加载无用组件影响性能。</b></p><h2>支付宝实际上给我们这些开发者上了很好的一课。</h2><p data-pid="Y_DXQcQp">作为开发者，我们的责任不仅仅是让程序跑起来，还要让程序尽可能的高效，减少冗余支出。</p><p data-pid="t-Q3dMJy">同时我们绝对不能照着sdk的范例搬不加思考。绝大多数sdk的范例都是application里面直接初始化的。对于一个demo，单个sdk的速度影响可以忽略，但是对于一个大项目，就有必要考虑一下如何使用多线程多进程和异步加载来优化性能。</p><h2>最后，不是不搞破解不搞修改就没必要学逆向。</h2><p data-pid="l4_TupsF">逆向不是仅仅用于破解和修改的。通过逆向他人的作品，我们可以学到其他开发者处理问题的更优方案，也可以在发现屎山时提醒自己避免类似问题。</p><p data-pid="meRkmCrk">在遇到一个无法解决的需求时，不如试试去逆向成功者的作品，这对开发水平的提高是很显著的。</p><p><br></p><p><br></p><p data-pid="2MqIv6GA">PS：支付宝用的很显然既不是原版dx也不是原版d8，编译到dex后.line的编号明显比较诡异</p><p></p><p></p>
1567222820